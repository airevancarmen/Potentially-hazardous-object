#importing libraries 
import matplotlib.pyplot as plt
import numpy as np 
import pandas as pd
import json
import requests

#data url
url= 'https://data.nasa.gov/resource/2vr3-k9wn.json'

# Package the request, send the request and catch the response: r
r = requests.get(url)

# Decode the JSON data into a dictionary: json_data
data= r.json()

# print(data) to check 

#create a dataframe from a json : df
df1 = pd.DataFrame.from_dict(data, orient='columns')

#drop the rows where at least one element is missing
clean = df.dropna()

print(len(clean))
#selecting the variable of interest. The variable moid_au is the minimum orbit intersection distance. moid_au defines if an object is potentially dangerous. Risk AU < 0.05 AU. AU=Astronomical units

newdf = clean[['moid_au', 'h_mag']]

#I don´t get why it shows me a string. I´m still not familiar with the json.
newdf['moid_au'] = [float(i) for i in newdf['moid_au']]
newdf['h_mag'] = [float(i) for i in newdf['h_mag']]

#wanted dataframe
print(newdf.loc[(newdf['moid_au'] < 0.05) & (newdf['h_mag'] > 22.00) ].count())


 

#notes of dataframe filters that work
#df_pop_ceb = df_urb_pop[df_urb_pop['CountryCode'] == 'CEB']
#gapminder_2002 = gapminder[gapminder['year']==2002]

for item in moi:
    print(item['moid_au']
 if item['moid_au'] <0.05 ;
